<style>

  #Unknown { display: none; }

</style>


<script type="text/javascript">
var tt_cancel_destination = "/clinic";  // /management"
</script>

<form method='post' action="edit_stock">

<%optionsString = []
  #optionsString << "Damaged"
  optionsString << "Expired/Damaged"
  optionsString << "Given to other clinics"
  optionsString << "Receipts from other clinics"
  optionsString << "Went missing"
  #optionsString << "Other"
 options = "<option>" "" "</option>"
    #raise @drugs.to_yaml
    @drugs.each{|drug|
      #raise drug[0].to_yaml
      options += "<option value = '#{drug}'>#{drug}</option>"
    }
%>
<%= touch_select_tag "REASON", '', options_for_select(optionsString),
        {:id => "edit_reason",
         :multiple => false,
         :optional => false,
         :helpText => "Relocation/disposal reason",
         :tt_pageStyleClass => "NoKeyboard NoInput small"  } %>

<%= text_field_tag "drug_name", nil, {:id => 'drug_name', :field_type => 'alpha', 
  :helpText => 'Drug name', 
  :ajaxURL =>  '/drug/available_name?search_string=', 
  :condition => "$('edit_reason').value != 'Receipts from other clinics'", :tt_onLoad  => '' } %>

<%= select_tag "drug_name", options, {:id => 'drug_name', :field_type => 'alpha',
  :helpText => 'Drug name',
  :condition => "$('edit_reason').value == 'Receipts from other clinics'", :tt_onLoad  => '' } %>

<%= touch_date_tag "encounter_date", 'encounter_date', nil,
    {:id => "delivery_date",
     :absoluteMax => Date.today,
     :tt_onload    => "$('helpText'+tstCurrentPage).innerHTML = ($('edit_reason').value + '  Date')"} %>

<%= text_field_tag "number_of_tins", nil, {:helpText => 'Number of tins', 
    :field_type => 'number', :absoluteMin => "1", 
    :min => "1", :tt_pageStyleClass => "Numeric NumbersOnly"}  %>

<%= text_field_tag "number_of_pills_per_tin", nil, {:helpText => 'Number of pills per tin', 
    :field_type => 'number', :absoluteMin => "1", 
    :min => "1", :tt_pageStyleClass => "Numeric NumbersOnly"}  %>

<%= touch_date_tag "expiry_date", 'encounter_date', nil,
    {:id => "delivery_date",
     :maxDate => (Date.today + 20.year).to_date,	
     :condition => "selectedValue('edit_reason') == 'Receipts from other clinics'" ,
     :helpText => "Expiry date"} %>

</form>
